<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- 4.15.6-GA -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="combined.css"/>
    <script src="split/split.min.js"></script>
    <link rel="stylesheet" href="inline_styles.css"/>
    <style type="text/css">
        /* <![CDATA[ */
            
        /* ]]> */
    </style>
</head>
<body>

<div class="full-height-container">
<div id="sidebar" class="split">
<div class="navgroup" id="search">
<form action="search.html" class="aui">
<input type="text" name="q" id="tipue_search_input" class="medium-field text">
<input class="button submit" type="submit" value="Search"></form>
</div>
<div class="navgroup" id="navigation">
<ul><li><span><a href="page378733115.html">003_How-to articles</a></span><input type="checkbox" checked/><ul><li><span><a href="page378083193.html">001_How to 搭建 virtual box 虚拟机TAF环境</a></span></li><li><span><a href="page684934474.html">001_trace traffic CLI user guide</a></span></li><li><span><a href="page378733060.html">002_How to配置 vFPC上的eth口和IP地址以及路由</a></span></li><li><span><a href="page378733094.html">003_How to run using new TAF</a></span></li><li><span><a href="page378734659.html">004_How to compile RCP subsystems</a></span></li><li><span><a href="page381296667.html">008_How to run cases in CI for mcRNC</a></span></li><li><span><a href="page381300257.html">009_How to mapping IL build to APP build</a></span></li><li><span><a href="page381300932.html">010_How to write python keyword via eclipse</a></span></li><li><span><a href="page404396307.html">012_How to create AMR call on RNC</a></span></li><li><span><a href="page382604403.html">013_How to configure traffic env on CloudIL</a></span></li><li><span><a href="page384534260.html">014_How to vRNC prb编译&打patch方法</a></span></li><li><span><a href="page385645780.html">015_How to run FT case on vFPC</a></span></li><li><span><a href="page386635558.html">016_How to handle Customer pronto</a></span></li><li><span><a href="page401455707.html">018_How to investigate deamon execute fail</a></span></li><li><span><a href="page419208059.html">023_How to Install Package On Cloud</a></span></li><li><span><a href="page417877522.html">023_how to use wireshark</a></span></li><li><span><a href="page427532291.html">025_How to patch for IL Iu/lub signaling PRBs and RPM</a></span></li><li><span><a href="page427549312.html">027_How to modify yaml file and scale out one USPU</a></span></li><li><span><a href="page404421333.html">029_how to debug SS_ILEITP in SE node</a></span></li><li><span><a href="page429277551.html">030_how to rebuild to the newest image for ESPOO EEcloud vFPC</a></span></li><li><span><a href="page430502064.html">031_How to manually run signaling case for mcRNC and vRNC</a></span></li><li><span><a href="page437136800.html">032_How to install a 64bit FPC</a></span></li><li><span><a href="page437137963.html">033_How to trace code modification in CCI static analysis and CCI FT</a></span><input type="checkbox"/><ul><li><span><a href="page453839101.html">CCI Knowledge Base</a></span></li></ul></li><li><span><a href="page437138243.html">034_How to use CI tool run CloudIL CRT</a></span></li><li><span><a href="page438109030.html">035_vRNC 安装&Troubleshooting</a></span></li><li><span><a href="page446369400.html">036_How to apply for a new PRB and let its running</a></span></li><li><span><a href="page450477479.html">037_how to configure VRF in CloudIL</a></span></li><li><span><a href="page452973625.html">038_How to add SCLI command on RCP1.0</a></span></li><li><span><a href="page453842966.html">039_How to deploy  RCP  stack</a></span></li><li><span><a href="page474054977.html">041_How to rebase feature branch with trunk</a></span></li><li><span><a href="page476307430.html">042_How to set SCLI to unsupported_cmds</a></span></li><li><span><a href="page485405903.html">043_How to create docker env</a></span></li><li><span><a href="page488081735.html">043_Performance_capacity_test</a></span></li><li><span><a href="page488098222.html">044_How to Send Traffic on CloudIL</a></span></li><li><span><a href="page493867047.html">044 cm develop guide</a></span></li><li><span><a href="page505418768.html">045_How to update message parameter in SS_ILICL</a></span></li><li><span><a href="page512838087.html">046_How_to_install_RCP2.0</a></span></li><li><span><a href="page750730769.html">047_RCP2.0 node deployment 启动服务查询方法</a></span></li><li><span><a href="page514148913.html">048_How to delete the duplicate tabs in the robot test case file</a></span></li><li><span>049_How to do upgrade and rollback for RCP2.0</span></li><li><span><a href="page548560935.html">050_How To Use The TestCenter</a></span></li><li><span><a href="page548566818.html">051_How to install the RCP2.0 use the scripts</a></span></li><li><span><a href="page548566912.html">052_How to run ut in the FPC</a></span></li><li><span><a href="page548566936.html">053_How to add soft link for the TRHRobotTest test cases</a></span></li><li><span><a href="page548566974.html">054_Usefull examples for write robot cases</a></span></li><li><span><a href="page548567083.html">055_How to setup the upgrade test case env</a></span></li><li><span><a href="page548567345.html">056_How to send 5G traffic on FPC</a></span></li><li><span><a href="page772764400.html">057_How figure out the responsible team via the service name</a></span></li><li><span><a href="page623670270.html">057_How to send 4G traffic on FPC</a></span></li><li><span><a href="page774277262.html">058_How to create koji env</a></span></li><li><span><a href="page759532258.html">058 how to check fp-rte and CCS core info</a></span></li><li><span><a href="page804850242.html">061 How to get code line info when debug the issue of app and kernel</a></span></li><li><span><a href="page830761561.html">062_How to write a spec</a></span></li><li><span><a href="page839804914.html">063_How_to_print_compile_command_for_DPDK</a></span></li><li><span><a href="page1402686023.html">064_How_to_test_auto_healing_for_vRAN2.0</a></span></li><li><span><a href="page1373310896.html">git | useful git commands</a></span></li><li><span><a href="page1129765404.html">how to build knife rpm package for 5G</a></span></li><li><span><a href="page1458893820.html">onenote | 2016版本onenote安装及快捷键配置</a></span></li><li><span><a href="page548560900.html">TestCenter Guide</a></span></li><li><span><a href="page1102800877.html">vdu</a></span></li></ul></li></ul>
</div>
</div>
<div id="content" class="split">
<div class='wiki-page'>
<div class='wiki-title'>
<h1 class='page-title-lvl-cover' id='Bookmark335'>049_How to do upgrade and rollback for RCP2.0</h1>
</div>
<div class='wiki-content'>
<p> </p><p><img style="margin: 2px; border: 1px solid #ddd; box-sizing: border-box; vertical-align: text-bottom;" src="img_133.png" width="250" height="250" /></p><p> </p><div style="border: none;border-bottom: solid rgb(68,114,196) 1.0pt;padding: 0.0cm 0.0cm 4.0pt 0.0cm;"><p align="center" class="MsoTitleCxSpFirst" style="text-align: center;"><span>SW upgrade User guide for RCP2.0</span></p><p align="center" class="MsoTitleCxSpLast" style="text-align: center;"><span>(UVM solution) </span></p></div><a name="Bookmark336"></a><h2 id="Bookmark336"><span><span>1.1<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Install RCP SWM Tool to host controller</span><span> </span></h2><a name="Bookmark337"></a><h3 id="Bookmark337"><span><span><span>1.1.1<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span></span><span><span>Download RCP SWM tool script from SCM build server</span></span><span> </span></h3><p class="MsoNormal"><span><span>  </span><span> </span>Download <span style="background: yellow;">rcp_swm_tool.tgz</span> from the link below.</span></p><p class="MsoNormal"><span><a rel="nofollow" href="https://confluence.ext.net.nokia.com/%20http:/halebopp.tre.noklab.net:8080/pilivee/RCP/rcp2.0/release/latest/tools/rcp_swm_tool.tgz" title="https://confluence.ext.net.nokia.com/%20http:/halebopp.tre.noklab.net:8080/pilivee/RCP/rcp2.0/release/latest/tools/rcp_swm_tool.tgz"><span> </span>http://halebopp.tre.noklab.net:8080/pilivee/RCP/rcp2.0/release/latest/tools/rcp_swm_tool.tgz </a><u><span style="color: rgb(5,99,193);"> </span></u></span></p><p><span> </span></p><a name="Bookmark338"></a><h3 id="Bookmark338"><span style="color: rgb(31,73,125);"><span>1.1.2<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Upload RCP SWM tool to host controller</span><span> </span><span style="color: rgb(31,73,125);"> </span></h3><p class="MsoNormal"><span><span>  </span>Decompress it and put the RCP SWM tool to the host controller as below. </span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="width: 614.0px;background: rgb(159,211,164) none repeat scroll 0.0% 0.0%;border-collapse: collapse;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNormal"><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 rcp_swm_tool(keystone_hranuser3)]$ pwd</span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">/home/hranuser2/rcp_swm_tool</span></span></span><span> </span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 rcp_swm_tool(keystone_hranuser3)]$ ls</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">actions<span>  </span>cli<span>  </span>config<span>  </span>lib<span>  </span>lib_thirdparty<span>  </span>log<span>  </span><span style="background: yellow;">rcp_upgrade_tool.py</span><span>  </span>utils</span></span></span></p></td></tr></tbody></table></div><p><span> </span> <span> </span><span> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: Calibri , sans-serif;color: windowtext;"> </span></p><a name="Bookmark339"></a><h2 id="Bookmark339"><span><span>1.2<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Using OpenStack RC file in RCP SWM Tool</span><span> </span></h2><a name="Bookmark340"></a><h3 id="Bookmark340"><span><span><span>1.2.1<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span></span><span><span>Download OpenStack RC file</span></span><span><span>  </span></span></h3><p class="MsoNormal"><span>Please login to OpenStack dashboard,<span>  </span>Choose “Project”-&gt;“Compute”-&gt;”Access &amp;Security”-&gt;”API Access”</span></p><p class="MsoNormal" style="line-height: normal;"><span> </span></p><p class="MsoNormal" style="line-height: normal;"><span style="font-size: 12.0pt;font-family: &quot;Times New Roman&quot; , serif;"> </span></p><p class="MsoNormal" style="line-height: normal;"><span style="font-size: 12.0pt;font-family: &quot;Times New Roman&quot; , serif;"> </span></p><p class="MsoNormal" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;"><span>   </span></span></p><p class="MsoNormal" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;">Click “Download OpenStack RC File v2.0”, the browser will download this RC file (example: hran3-openrc.sh). You can also Click “Download OpenStack RC File v3.0”. </span></p><a name="Bookmark341"></a><h3 id="Bookmark341"><span><span>1.2.2<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Upload OpenStack RC file to host controller and using it in RCP SWM Tool</span><span> </span></h3><p class="MsoNormal" style="margin-left: 14.15pt;"><span>Please upload OpenStack RC file to host controller and run ‘</span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">source</span><span>’ command:</span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser2)]$ pwd</span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">/home/hranuser2</span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;"> </span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser2)]$ ls</span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">basic<span>  </span>heat<span>  </span><span style="background: yellow;">hran3-openrc.sh</span><span>  </span>mykey.pem<span>  </span>net<span>  </span>openrc.hranuser3<span>  </span>rcp-heat-templates-v40-29-g277bb64.tar<span>  </span><span style="background: yellow;">rcp_swm_tool</span><span>  </span>redundant<span>  </span>single<span>  </span>temp</span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ <em>chmod 777 hran2-openrc.sh</em></span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser2)]$ <span style="background: yellow;">source ./hran2-openrc.sh</span></span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">Please enter a path for your CA certificate pem file, or press enter if you are not using HTTPS <span style="background: yellow;">&lt;press Enter here&gt;</span></span></p><p class="MsoNormal"><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">Please enter your OpenStack Password: &lt; give password here. example: <span style="background: yellow;">systeM!23</span>&gt;</span></p></td></tr></tbody></table></div><p></p><p class="MsoNormal"><span> </span></p><a name="Bookmark342"></a><h2 id="Bookmark342"><span><span>1.3<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Prepare upgrade image</span><span> </span></h2><p class="MsoNormal"> </p><p class="MsoNormal"><strong><span style="font-size: 12.0pt;line-height: 115.0%;">Note: </span></strong></p><p class="MsoListParagraphCxSpFirst" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>Please make sure upgrade image version <span style="background: yellow;">newer than current image version</span>, RCP upgrade tool can’t validate image version during upgrade.</span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>The <span style="background: yellow;">image which is used in current should not be deleted</span>. </span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>The image name which is used in current should be <span style="background: yellow;">unique</span>.</span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>The image name which is used in upgrade should be <span style="background: yellow;">unique</span>.</span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>Tenant should have enough quota for the flavor of UVM.</span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>Stack status shall be in “&lt;action&gt;_complete” status. If status in “&lt;action&gt;_failure” or “&lt;action&gt;_ongoing”, upgrade VNF maybe failure.</span></p><p class="MsoListParagraphCxSpMiddle" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>All instances in the stack should be in active status.</span></p><p class="MsoListParagraphCxSpLast" style="margin-left: 21.0pt;text-indent: -21.0pt;"><span style="font-family: Symbol;"><span>·<span style="font: 7.0pt &quot;Times New Roman&quot;;">           </span></span></span><span>The result of ‘dvmcli --summary-nodes’ should not has node in not-initialized status.</span></p><a name="Bookmark343"></a><h1 id="Bookmark343"><span><span>2<span style="font: 7.0pt &quot;Times New Roman&quot;;">       </span></span></span><span>Upgrade VNF</span><span> </span></h1><a name="Bookmark344"></a><h2 id="Bookmark344"><span><span><span>2.1<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span></span><span><span>Prepare</span></span><span> </span></h2><a name="Bookmark345"></a><h3 id="Bookmark345"><span><span><span><span><span><span>2.1.1<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span></span></span><span><span><span>Account </span></span><span>and SSH IP</span></span><span> </span></span></span></h3><p class="MsoNoSpacing" style="text-indent: 16.5pt;line-height: normal;"><span><span><span style="font-family: Calibri , sans-serif;color: windowtext;">Operator should prepare SSH private key file for “_nokrcpautoremoteuser”, which is recommended account for accessing VNF during upgrade.</span></span></span></p><p class="MsoNoSpacing" style="text-indent: 16.5pt;line-height: normal;"><span><span><span style="font-family: Calibri , sans-serif;color: windowtext;"> </span></span></span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ nova keypair-show RCP_key</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">ERROR (NotFound): <span style="background: yellow;">Keypair RCP_key not found for user</span> </span></span></span><span><span><span style="font-size: 10.0pt;line-height: 115.0%;color: black;">（</span></span></span><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">if <span style="background: yellow;">RCP_key not found</span>, no need to execute the below command <span style="background: yellow;">nova keypair-delete RCP_key</span></span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;color: black;">）</span></span></span><span> </span></p><p align="right" class="MsoNormal" style="margin-right: 5.0pt;text-align: right;"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser2)]$ nova keypair-delete RCP_key</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser2)]$ nova keypair-add RCP_key &gt; ~/.ssh/RCP_private_key.pem</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ nova keypair-show RCP_key</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ nova keypair-show RCP_key | grep Public | awk -F': ' '{print $2}' &gt; ~/.ssh/RCP_public_key.pub</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ ls -l ~/.ssh/RCP_public_key.pub</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">-rw-------</span></span></span><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;"> 1 hranuser2 users 399 Aug 25 09:14 /home/hranuser2/.ssh/RCP_public_key.pub</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ cat ~/.ssh/RCP_public_key.pub</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCzgmcW0XWxnKjhynnVn4mKg1EYj+zPtM6mJiIU8x91yWlYMVduwCWLpqpfjxYn8bEuaRlxd2yEDesFecX4lC/QJNOobbCoe7cIumQH+FEDx+3efsiPEkQkGV8aaTe6+RqyqeJDcy9OWNbfjLZep7pkkGsRHHXVd8eGeBCZFG+RckHUDpeS5SbpsyX5kQUAMbCR6MnFyEcy85krbgkzz3IDaLce/I38zV3rT5Y+EDBAYfqfmTlgHVZqtm2MjF7wsOTLE9PLNns0Ym9nubU4VZQ2yeEqagoLsm/MYmtypDzT8seocKtN6KGRaVlNXWjdaUlJlw5InbWV3DB98oJxrEJJ Generated-by-Nova</span></span></span><span> </span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;"> </span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[root@mn-0:/home/robot] (<span style="background: yellow;">Note: This below vi command is executed on RCP</span>)</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;"># vi /opt/nokia/lib/internalsshkeys/_nokrcpautoremoteuser/authorized_keys</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDvPpEuUZBYdtcsfhA9Bnd90Kui7JmRouk2GZjYKEmOIpk0Rz9+8ZOrENiQsb9TzMnO0LjCYEwJuaBZSjV/1aXH52aa2jrPTvI0qRaU7CtFI6/ju3H8D05knqna6meWCJdDcqvQOWcyEe/vwzNuk24ObPclmzI5uL3SBPjUWz/JmQZXCJRwQBncZrUy/UGm8Ia87vOK0045EQLR0C8EjmbcoDJEgkCprEqXUbhCZ0iJgsSQUkqgEAsfIaSxJirr/hy7tucukFfe2mxnpI4McQGtNocS2q3vdCowF4B79QM2lZIOifN2aJ9600iuOXqViWQ3/T6vHCE26ee1jNMRRnCJ Generated-for-RCP-_nokrcpautoremoteuser</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEXXkCjU7MB3/Q7gefmYM+AbjDA8PrMtR7qogSeF22gISvIeIJ0K9TCD/T8yZOz28Tui2Vu4wF9xpHx+nC9GrLB6bRy13PBcCkj82q0Q3DN41DjJadpdVGsz23IvnIvFwCmY5IALotRQbafpdKVvi1GAN4lgrlxt+UbhVmbcoMQ9MNfgYHzV5CPxXdc+wbNXx+4I5NqiO96RxjAT1qi3QBGdcbIMvbO/pxWBs/0TlQ89ROX9TMpM9M1xqehLJOnBuz4Lktyp0YVQUdf8QDchLoVE+gVvPTZDhY+09boBROSjB+mD1Mdiy7qaMfd4ePz28xs7h84e8WIybRbFx4GfzJ <span style="background: yellow;">Generated-by-Nova</span></span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">(Note: Here you can found two keys in the file, please delete the one which is end with “Generated-by-Nova” and add the result of “cat ~/.ssh/RCP_public_key.pub” )</span></span></span><span> </span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ chmod 600 /home/hranuser2/.ssh/RCP_private_key.pem </span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser3@controller-0 ~(keystone_hranuser3)]$ ssh -i ~/.ssh/RCP_private_key.pem _nokrcpautoremoteuser@10.70.15.155(management node external IP)</span></span></span></p></td></tr></tbody></table></div><p><span> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span><span><span style="font-family: Calibri , sans-serif;color: windowtext;"> </span></span></span></p><p class="MsoNoSpacing" style="line-height: normal;"><span><span><span style="font-family: Calibri , sans-serif;color: windowtext;"> </span></span></span></p><p class="MsoNoSpacing" style="line-height: normal;"><span><span><span style="font-family: Calibri , sans-serif;color: windowtext;">SSH IP is management node external IP:</span></span></span></p><p class="MsoNormal"> </p><p class="MsoNormal"><span><span><span>Note:</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">[hranuser2@controller-0 ~(keystone_hranuser2)]$ nova keypair-show RCP_key</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">No handlers could be found for logger &quot;keystoneauth.identity.generic.base&quot;</span></span></span></p><p class="MsoNormal"><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;">ERROR (DiscoveryFailure): <span style="background: yellow;">Cannot use v2 authentication with domain scope</span></span></span></span></p><p class="MsoNormal"><span><span><span>If you meet the error ‘</span></span></span><span><span><span style="font-size: 10.0pt;line-height: 115.0%;font-family: &quot;Courier New&quot;;color: black;background: yellow;">Cannot use v2 authentication with domain scope</span><span>’, please open a new ssh session for the same controller.</span></span></span></p><p><span> </span><span> </span></p><a name="Bookmark346"></a><h2 id="Bookmark346"><span><span><span>2.2<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span></span><span><span>Upgrade VNF</span></span><span> </span></h2><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: Calibri , sans-serif;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: Calibri , sans-serif;color: windowtext;">Below is an example to upgrade VNF from running version to image up_demo_2:</span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">[hranuser2@controller-0 rcp_swm_tool(keystone_hranuser2)]$ pwd</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">/home/hranuser2/rcp_swm_tool</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">[hranuser2@controller-0 rcp_swm_tool(keystone_hranuser2)]$</span><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: yellow;">python ./rcp_upgrade_tool.py -u -i image=RCP2.0_17.34.0 --ssh-key ~/.ssh/RCP_private_key.pem --vnf-ssh-ip 10.70.31.67<span>  </span>--stack cm_0828</span><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Version: 2017.06.16</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Upgrade information:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"><span>  </span>user name<span>  </span>: hranuser7</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"><span>  </span>tenant name: hran7</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"><span>  </span>new image<span>  </span>: image=up_demo_2</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Pre-check start ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Pre-check ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Take snapshot for current stack.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Take snapshot for current stack successfully.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Create UVM instance ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Create UVM instance ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Conversion start...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Wait 60 seconds for UVM instance startup ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Check conversion result ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Conversion ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Delete UVM instance ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Delete UVM instance ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Stop instances:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-2.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-1.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance mn-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-2.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance as-1.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Stop instance mn-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Stop instances ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Update stack walle ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Update stack walle ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">Start instances:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-2.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-1.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance mn-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-2.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance as-1.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);">&gt;&gt;Start instance mn-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: yellow;">Start instances ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;color: windowtext;background: yellow;">Upgrade successfully.</span><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p></td></tr></tbody></table></div><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-family: &quot;Courier New&quot;;"> </span></p><p class="MsoNormal"><span>After the above output given, it means upgrade finished, all node(s) will be active in new image.</span></p><a name="Bookmark347"></a><h2 id="Bookmark347"><span><span>2.3<span style="font: 7.0pt &quot;Times New Roman&quot;;">      </span></span></span><span>Checking VNF after upgrade</span><span> </span></h2><p class="MsoNormal"><span>RCP upgrade tool couldn’t do full checking after upgrade, so operator need to healthy checking after upgrade.</span></p><p class="MsoListParagraph" style="margin-left: 27.0pt;text-indent: -18.0pt;"><span><span>1.<span style="font: 7.0pt &quot;Times New Roman&quot;;">       </span></span></span><span>UVM should be deleted and All node(s) should be started up: all nodes status should be “</span><span style="font-family: &quot;Courier New&quot;;">ACTIVE</span><span>” and Power State should be “</span><span style="font-family: &quot;Courier New&quot;;">Running</span><span>”.</span></p><p class="MsoNormal"> </p><p class="MsoListParagraph" style="margin-left: 27.0pt;text-indent: -18.0pt;"><span><span>2.<span style="font: 7.0pt &quot;Times New Roman&quot;;">       </span></span></span><span>Image version should be new version.<span>  </span></span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]<span>                 </span></span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># swmshowversion all<span>                    </span></span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">cp-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-1 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">mn-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">up-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;background: rgb(217,217,217);"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">root@mn-0 [FP]<span>  </span>&gt; show software version all </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">cp-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-1 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">mn-0 RCP2.0_17.34.0_r19016-170821-092148</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">up-0 RCP2.0_17.34.0_r19016-170821-092148</span></p></td></tr></tbody></table></div><p class="MsoNormal"><span> </span></p><p class="MsoListParagraph" style="margin-left: 27.0pt;text-indent: -18.0pt;"><span><span>3.<span style="font: 7.0pt &quot;Times New Roman&quot;;">       </span></span></span><span>All nodes should be started up in VNF. </span></p><p class="MsoNormal"><span>Use “dvmcli --list-nodes ” and “dvmcli -s &lt;node name&gt;”to check all nodes status:</span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr style=""><td valign="top" width="609" class="confluenceTd" style=""><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli --list-nodes</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">cp-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-1</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">mn-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">up-0 </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli -s cp-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">cp-0:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">administrative(UNLOCKED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">operational(ENABLED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">procedural(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">availability(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli -s ei-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-0:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">administrative(UNLOCKED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">operational(ENABLED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">procedural(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">availability(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli -s ei-1</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">ei-1:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">administrative(UNLOCKED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">operational(ENABLED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">procedural(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">availability(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli -s mn-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">mn-0:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">administrative(UNLOCKED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">operational(ENABLED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">procedural(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">availability(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[root@mn-0:/home/robot]</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"># dvmcli -s up-0</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">up-0:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">administrative(UNLOCKED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">operational(ENABLED)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">procedural(-)</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">availability(-)</span></p></td></tr></tbody></table></div><p class="MsoNormal"><span>System service should in running status:</span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">robot@mn-0:~$ systemctl is-system-running </span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">running</span></p></td></tr></tbody></table></div><p class="MsoNormal"><span> </span></p><p class="MsoNormal"><span>If upgrade fails, failure information will be recorded into &lt;rcp_upgrade_tool_dir&gt;/log/upgrade_tool.log. After upgrade, UVM will be deleted.</span></p><a name="Bookmark348"></a><h1 id="Bookmark348"><span><span><span>3<span style="font: 7.0pt &quot;Times New Roman&quot;;">       </span></span></span></span><span><span>Rollback VNF</span></span><span> </span></h1><p class="MsoNormal"><span>Below is an example for rollback to original build:</span></p><div class="table-wrap"><table border="1" cellpadding="0" cellspacing="0" class="MsoTableGrid confluenceTable" style="background: rgb(159,211,164);border-collapse: collapse;border: none;; font-size:1.0em"><tbody><tr><td valign="top" width="614" class="confluenceTd" style=""><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">[hranuser2@controller-0 rcp_swm_tool(keystone_hranuser2)]$ <span style="background: yellow;">python ./rcp_upgrade_tool.py --rollback --stack=cm_0828</span></span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Version: 2017.06.16</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Rollback stack walle ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Stop instances:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-2.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-1.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance mn-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-2.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance as-1.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Stop instance mn-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Stop instances ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Restore walle ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Restore walle ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">Start instances:</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-2.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-1.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance mn-0.local ...</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-2.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance as-1.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;">&gt;&gt;Start instance mn-0.local ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;background: yellow;">Start instances ok.</span></p><p class="MsoNoSpacing" style="line-height: normal;"><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;background: yellow;">Rollback successfully.</span><span style="font-size: 10.0pt;font-family: &quot;Courier New&quot;;color: windowtext;"> </span></p></td></tr></tbody></table></div><p class="MsoNormal"><span>If rollback fails, </span><span>failure information will be reported into &lt;rcp_upgrade_tool_dir&gt;/log/upgrade_tool.log. </span></p><p class="MsoNormal"><span> </span></p>
</div>
</div>
</div>
</div>
<script>
Split(['#sidebar', '#content'], {
    sizes: [15, 85],
    minSize: 100
});
</script>

</body>
</html>
